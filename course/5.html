<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>5. Writing the InSpec Controls | InSpec Profile Developers Course</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="The MITRE InSpec Team&#39;s introduction to InSpec Profile Development">
    
    <link rel="preload" href="/inspec-developer/assets/css/0.styles.8a73f461.css" as="style"><link rel="preload" href="/inspec-developer/assets/js/app.7d79d2ea.js" as="script"><link rel="preload" href="/inspec-developer/assets/js/2.fb9f3b04.js" as="script"><link rel="preload" href="/inspec-developer/assets/js/22.0df2a838.js" as="script"><link rel="prefetch" href="/inspec-developer/assets/js/10.9f2a48b6.js"><link rel="prefetch" href="/inspec-developer/assets/js/11.3f10e607.js"><link rel="prefetch" href="/inspec-developer/assets/js/12.2c54c5b2.js"><link rel="prefetch" href="/inspec-developer/assets/js/13.2d2829d7.js"><link rel="prefetch" href="/inspec-developer/assets/js/14.afa40c96.js"><link rel="prefetch" href="/inspec-developer/assets/js/15.1755bca0.js"><link rel="prefetch" href="/inspec-developer/assets/js/16.3b64e1db.js"><link rel="prefetch" href="/inspec-developer/assets/js/17.0ae77dc9.js"><link rel="prefetch" href="/inspec-developer/assets/js/18.59ee93f4.js"><link rel="prefetch" href="/inspec-developer/assets/js/19.ac409da4.js"><link rel="prefetch" href="/inspec-developer/assets/js/20.e14567f9.js"><link rel="prefetch" href="/inspec-developer/assets/js/21.02c647c0.js"><link rel="prefetch" href="/inspec-developer/assets/js/23.01daa5e7.js"><link rel="prefetch" href="/inspec-developer/assets/js/24.6902a542.js"><link rel="prefetch" href="/inspec-developer/assets/js/25.89b245b5.js"><link rel="prefetch" href="/inspec-developer/assets/js/26.5a383699.js"><link rel="prefetch" href="/inspec-developer/assets/js/27.3994ba0a.js"><link rel="prefetch" href="/inspec-developer/assets/js/28.6658fa31.js"><link rel="prefetch" href="/inspec-developer/assets/js/29.a9ef1e9e.js"><link rel="prefetch" href="/inspec-developer/assets/js/3.27e58ff9.js"><link rel="prefetch" href="/inspec-developer/assets/js/30.34654713.js"><link rel="prefetch" href="/inspec-developer/assets/js/4.129956aa.js"><link rel="prefetch" href="/inspec-developer/assets/js/5.55b1ac70.js"><link rel="prefetch" href="/inspec-developer/assets/js/6.1416f2d5.js"><link rel="prefetch" href="/inspec-developer/assets/js/7.55d4d3c0.js"><link rel="prefetch" href="/inspec-developer/assets/js/8.fe08e3d8.js"><link rel="prefetch" href="/inspec-developer/assets/js/9.15212c20.js">
    <link rel="stylesheet" href="/inspec-developer/assets/css/0.styles.8a73f461.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/inspec-developer/" class="home-link router-link-active"><!----> <span class="site-name">InSpec Profile Developers Course</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/inspec-developer/course/" class="nav-link router-link-active">
  Course
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/LinuxInstall.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/MacInstall.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/WindowsInstall.html" class="nav-link">
  Windows
</a></li></ul></div></div><div class="nav-item"><a href="/inspec-developer/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/inspec-developer/contact/" class="nav-link">
  Contact
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/inspec-developer/course/" class="nav-link router-link-active">
  Course
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/LinuxInstall.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/MacInstall.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/inspec-developer/installation/WindowsInstall.html" class="nav-link">
  Windows
</a></li></ul></div></div><div class="nav-item"><a href="/inspec-developer/resources/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/inspec-developer/contact/" class="nav-link">
  Contact
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/inspec-developer/course/" aria-current="page" class="sidebar-link">1. About InSpec</a></li><li><a href="/inspec-developer/course/2.html" class="sidebar-link">2. Starting the Journey</a></li><li><a href="/inspec-developer/course/3.html" class="sidebar-link">3. Studying an InSpec profile</a></li><li><a href="/inspec-developer/course/4.html" class="sidebar-link">4. Exploring the InSpec Shell</a></li><li><a href="/inspec-developer/course/5.html" aria-current="page" class="active sidebar-link">5. 
      
      
      
      the InSpec Controls</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#_5-writing-the-inspec-controls" class="sidebar-link">5. Writing the InSpec Controls</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#security-configuration-requirements" class="sidebar-link">Security &amp; Configuration Requirements</a></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#requirement-1-nginx-version" class="sidebar-link">Requirement (1) - NGINX Version</a></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#requirement-2-nginx-modules-are-installed" class="sidebar-link">Requirement (2) - NGINX Modules are Installed</a></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#requirement-3-permission-on-the-nginx-conf-file" class="sidebar-link">Requirement (3) - Permission on the nginx_conf file</a></li></ul></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#_5-1-refactoring-the-code-to-use-inputs" class="sidebar-link">5.1. Refactoring the code to use Inputs</a></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#_5-2-multiple-inputs-example" class="sidebar-link">5.2. Multiple Inputs Example</a></li><li class="sidebar-sub-header"><a href="/inspec-developer/course/5.html#_5-3-running-the-baseline-straight-from-github" class="sidebar-link">5.3. Running the baseline straight from Github</a></li></ul></li><li><a href="/inspec-developer/course/6.html" class="sidebar-link">6. Generating Results</a></li><li><a href="/inspec-developer/course/7.html" class="sidebar-link">7. Viewing and Analyzing Results</a></li><li><a href="/inspec-developer/course/8.html" class="sidebar-link">8. Inspec Examples</a></li><li><a href="/inspec-developer/course/9.html" class="sidebar-link">9. Profile Inheritance and Overlays</a></li><li><a href="/inspec-developer/course/10.html" class="sidebar-link">10. From STIG to Profile</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_5-writing-the-inspec-controls"><a href="#_5-writing-the-inspec-controls" class="header-anchor">#</a> 5. Writing the InSpec Controls</h2> <p>Now that you understand which methods map to each requirement, you're ready to write InSpec controls.</p> <h3 id="security-configuration-requirements"><a href="#security-configuration-requirements" class="header-anchor">#</a> Security &amp; Configuration Requirements</h3> <p>Recall from <a href="/inspec-developer/course/4.html">Section 4</a> that we want to verify that our NGINX instance had been configured to meet the following requirements:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token number">1</span>. NGINX version <span class="token number">1.10</span>.3 or later.
<span class="token number">2</span>. the following NGINX modules should be installed:
   * <span class="token variable"><span class="token variable">`</span>http_ssl<span class="token variable">`</span></span>
   * <span class="token variable"><span class="token variable">`</span>stream_ssl<span class="token variable">`</span></span>
   * <span class="token variable"><span class="token variable">`</span>mail_ssl<span class="token variable">`</span></span>
<span class="token number">3</span>. the NGINX configuration <span class="token function">file</span> - <span class="token variable"><span class="token variable">`</span>/etc/nginx/nginx.conf<span class="token variable">`</span></span>- should:
   * be owned by the <span class="token variable"><span class="token variable">`</span>root<span class="token variable">`</span></span> user and group.
   * not be readable, writeable, or executable by others.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="requirement-1-nginx-version"><a href="#requirement-1-nginx-version" class="header-anchor">#</a> Requirement (1) - NGINX Version</h3> <p>The first requirement is for the NGINX version to be <code>1.10.3 or later</code>.</p> <p>We can check this using the InSpec <code>cmp</code> matcher.</p> <p>Replace the contents of <code>my_nginx/controls/example.rb</code> with this:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
  describe nginx <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'version'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token operator">&gt;=</span> <span class="token string-literal"><span class="token string">'1.10.3'</span></span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">The `nginx_conf` resource docs</p> <p><a href="https://www.inspec.io/docs/reference/resources/nginx_conf/" target="_blank" rel="noopener noreferrer"><code>nginx_conf</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>The test has an impact of 1.0, meaning it is most critical. A failure might indicate to the team that this issue should be resolved as soon as possible, likely by upgrading NGINX to a newer version. The test compares <code>nginx.version</code> against version 1.10.3.</p> <p><code>cmp</code> is one of InSpec's <a href="https://www.inspec.io/docs/reference/matchers/" target="_blank" rel="noopener noreferrer">built-in matchers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <code>cmp</code> understands version numbers and can use the operators ==, &lt;, &lt;=, &gt;=, and &gt;. <code>cmp</code> compares versions by each segment, not as a string. For example, &quot;7.4&quot; is less than than &quot;7.30&quot;.</p> <p>Next, run <code>inspec exec</code> to execute the profile on the remote target.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>inspec <span class="token builtin class-name">exec</span> /root/my_nginx -t docker://DOCKER_CONTAINER_ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This will ouput:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  Profile: InSpec Profile <span class="token punctuation">(</span>my_nginx<span class="token punctuation">)</span>
  Version: <span class="token number">0.1</span>.0
  Target:  docker://DOCKER_CONTAINER_ID

    ✔  nginx-version: NGINX version
       ✔  Nginx Environment version should <span class="token function">cmp</span> <span class="token operator">&gt;=</span> <span class="token string">&quot;1.10.3&quot;</span>


  Profile Summary: <span class="token number">1</span> successful control, <span class="token number">0</span> control failures, <span class="token number">0</span> controls skipped
  Test Summary: <span class="token number">1</span> successful, <span class="token number">0</span> failures, <span class="token number">0</span> skipped
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>You see that the test passes.</p> <h3 id="requirement-2-nginx-modules-are-installed"><a href="#requirement-2-nginx-modules-are-installed" class="header-anchor">#</a> Requirement (2) - NGINX Modules are Installed</h3> <p>The second requirement verifies that our required modules are installed.</p> <ul><li>http_ssl</li> <li>stream_ssl</li> <li>mail_ssl</li></ul> <p>Append your control file to add this describe block:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
  describe nginx <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'http_ssl'</span></span> <span class="token punctuation">}</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'stream_ssl'</span></span> <span class="token punctuation">}</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'mail_ssl'</span></span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">The `nginx_conf` resource docs</p> <p><a href="https://www.inspec.io/docs/reference/resources/nginx_conf/" target="_blank" rel="noopener noreferrer"><code>nginx_conf</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>The second control resembles the first; however, this version uses multiple <code>its</code> statements and the <code>nginx.modules</code> method. The <code>nginx.modules</code> method returns a list; the built-in <code>include</code> matcher verifies whether a value belongs to a given list.</p> <p>Run <code>inspec exec</code> on the target.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ inspec <span class="token builtin class-name">exec</span> /root/my_nginx -t docker://DOCKER_CONTAINER_ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Which again, will output:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
  Profile: InSpec Profile <span class="token punctuation">(</span>my_nginx<span class="token punctuation">)</span>
  Version: <span class="token number">0.1</span>.0
  Target:  docker://DOCKER_CONTAINER_ID

    ✔  nginx-version: NGINX version
       ✔  Nginx Environment version should <span class="token function">cmp</span> <span class="token operator">&gt;=</span> <span class="token string">&quot;1.10.3&quot;</span>
    ✔  nginx-modules: NGINX version
       ✔  Nginx Environment modules should include <span class="token string">&quot;http_ssl&quot;</span>
       ✔  Nginx Environment modules should include <span class="token string">&quot;stream_ssl&quot;</span>
       ✔  Nginx Environment modules should include <span class="token string">&quot;mail_ssl&quot;</span>


  Profile Summary: <span class="token number">2</span> successful controls, <span class="token number">0</span> control failures, <span class="token number">0</span> controls skipped
  Test Summary: <span class="token number">4</span> successful, <span class="token number">0</span> failures, <span class="token number">0</span> skipped
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>This time, both controls pass.</p> <h3 id="requirement-3-permission-on-the-nginx-conf-file"><a href="#requirement-3-permission-on-the-nginx-conf-file" class="header-anchor">#</a> Requirement (3) - Permission on the <code>nginx_conf</code> file</h3> <p>The third requirement verifies that the NGINX configuration file, <code>/etc/nginx/nginx.conf</code>:</p> <ul><li>is owned by the root user and group.</li> <li>is not be readable, writeable, or executable by others.</li></ul> <p>Append your control file to add this describe block:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
  describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/etc/nginx/nginx.conf'</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should be_owned_by <span class="token string-literal"><span class="token string">'root'</span></span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should be_grouped_into <span class="token string-literal"><span class="token string">'root'</span></span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_readable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_writable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_executable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">The `file` resource docs</p> <p><a href="https://www.inspec.io/docs/reference/resources/file/" target="_blank" rel="noopener noreferrer"><code>file</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>The third control uses the <code>file</code> resource. The first 2 tests use <code>should</code> to verify the <code>root</code> owner and group. The last 3 tests use <code>should_not</code> to verify that the file is not readable, writable, or executable by others.</p> <p>Run <code>inspec exec</code> on the target.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ inspec <span class="token builtin class-name">exec</span> /root/my_nginx -t docker://DOCKER_CONTAINER_ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Again, outputting:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>  Profile: InSpec Profile <span class="token punctuation">(</span>my_nginx<span class="token punctuation">)</span>
  Version: <span class="token number">0.1</span>.0
  Target:  docker://DOCKER_CONTAINER_ID

    <span class="token punctuation">..</span>.
    ×  nginx-conf: NGINX configuration <span class="token punctuation">(</span><span class="token number">1</span> failed<span class="token punctuation">)</span>
       ✔  File /etc/nginx/nginx.conf should be owned by <span class="token string">&quot;root&quot;</span>
       ✔  File /etc/nginx/nginx.conf should be grouped into <span class="token string">&quot;root&quot;</span>
       ×  File /etc/nginx/nginx.conf should not be readable by others
       expected File /etc/nginx/nginx.conf not to be readable by others
       ✔  File /etc/nginx/nginx.conf should not be writable by others
       ✔  File /etc/nginx/nginx.conf should not be executable by others


  Profile Summary: <span class="token number">2</span> successful controls, <span class="token number">1</span> control failure, <span class="token number">0</span> controls skipped
  Test Summary: <span class="token number">8</span> successful, <span class="token number">1</span> failure, <span class="token number">0</span> skipped
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>This time you see a failure. You discover that <code>/etc/nginx/nginx.conf</code> is potentially readable by others. Because this control also has an impact of 1.0, your team may need to investigate further.</p> <p>Remember, the first step, detect, is where you identify where the problems are so that you can accurately assess risk and prioritize remediation actions.</p> <p>For the second step, correct, you can use a configuration management tool or some other automation framework to correct compliance failures for you.</p> <p>You won't correct this issue in this module, but later you can check out the <a href="https://learn.chef.io/tracks/integrated-compliance#/" target="_blank" rel="noopener noreferrer">Integrated Compliance with Chef<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> track to learn more about how to correct compliance issues using Chef.</p> <h2 id="_5-1-refactoring-the-code-to-use-inputs"><a href="#_5-1-refactoring-the-code-to-use-inputs" class="header-anchor">#</a> 5.1. Refactoring the code to use Inputs</h2> <p>Your <code>my_nginx</code> profile is off to a great start. As your requirements evolve, you can add additional controls. You can also run this profile as often as you need to verify whether your systems remain in compliance.</p> <p>Let's review the control file, <code>example.rb</code>.</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
  describe nginx <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'version'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token operator">&gt;=</span> <span class="token string-literal"><span class="token string">'1.10.3'</span></span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
  describe nginx <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'http_ssl'</span></span> <span class="token punctuation">}</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'stream_ssl'</span></span> <span class="token punctuation">}</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> <span class="token string-literal"><span class="token string">'mail_ssl'</span></span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
  describe file<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/etc/nginx/nginx.conf'</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    it <span class="token punctuation">{</span> should be_owned_by <span class="token string-literal"><span class="token string">'root'</span></span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should be_grouped_into <span class="token string-literal"><span class="token string">'root'</span></span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_readable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_writable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
    it <span class="token punctuation">{</span> should_not be_executable<span class="token punctuation">.</span>by<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'others'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">The `nginx_conf` resource docs</p> <p><a href="https://www.inspec.io/docs/reference/resources/nginx_conf/" target="_blank" rel="noopener noreferrer"><code>nginx_conf</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <p>Although these rules do what you expect, imagine your control file contains dozens or hundreds of tests. As the data you check for, such as the version or which modules are installed, evolve, it can become tedious to locate and update your tests. You may also find that you repeat the same data in across multiple control files.</p> <p>One way to improve these tests is to use <code>inputs</code>. <code>Inputs</code> enable you to separate the <code>logic of your tests</code> from <code>the data your tests</code>. <code>Input files</code> are typically expressed as a <code>YAML</code> file.</p> <p><code>Profile Inputs</code> exist in your profile's main directory within the <code>inspec.yml</code> for global <code>inputs</code> to be used across all the controls in your profile.</p> <p>Let's create the <code>inspec.yml</code> file for our profile:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> my_nginx
<span class="token key atrule">title</span><span class="token punctuation">:</span> InSpec Profile
<span class="token key atrule">maintainer</span><span class="token punctuation">:</span> The Authors
<span class="token key atrule">copyright</span><span class="token punctuation">:</span> The Authors
<span class="token key atrule">copyright_email</span><span class="token punctuation">:</span> you@example.com
<span class="token key atrule">license</span><span class="token punctuation">:</span> Apache<span class="token punctuation">-</span><span class="token number">2.0</span>
<span class="token key atrule">summary</span><span class="token punctuation">:</span> An InSpec Compliance Profile
<span class="token key atrule">version</span><span class="token punctuation">:</span> 0.1.0
<span class="token key atrule">supports</span><span class="token punctuation">:</span>
  <span class="token key atrule">platform</span><span class="token punctuation">:</span> os

<span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx_version
    <span class="token key atrule">type</span><span class="token punctuation">:</span> string
    <span class="token key atrule">value</span><span class="token punctuation">:</span> 1.10.3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>To access an input you will use the input keyword. You can use this anywhere in your control code.</p> <p>For example:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
  describe nginx <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'version'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should cmp <span class="token operator">&gt;=</span> input<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'nginx_version'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>For our next control we require specific modules</p> <p>Example of adding an array object of servers:</p> <div class="language-YAML line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> servers
    <span class="token key atrule">type</span><span class="token punctuation">:</span> array
    <span class="token key atrule">value</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> server1
      <span class="token punctuation">-</span> server2
      <span class="token punctuation">-</span> server3
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Similarly as the above example we can edit our <code>inspec.yml</code> file like this:</p> <div class="language-YAML line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> my_nginx
<span class="token key atrule">title</span><span class="token punctuation">:</span> InSpec Profile
<span class="token key atrule">maintainer</span><span class="token punctuation">:</span> The Authors
<span class="token key atrule">copyright</span><span class="token punctuation">:</span> The Authors
<span class="token key atrule">copyright_email</span><span class="token punctuation">:</span> you@example.com
<span class="token key atrule">license</span><span class="token punctuation">:</span> Apache<span class="token punctuation">-</span><span class="token number">2.0</span>
<span class="token key atrule">summary</span><span class="token punctuation">:</span> An InSpec Compliance Profile
<span class="token key atrule">version</span><span class="token punctuation">:</span> 0.1.0
<span class="token key atrule">supports</span><span class="token punctuation">:</span>
  <span class="token key atrule">platform</span><span class="token punctuation">:</span> os

<span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx_version
    <span class="token key atrule">type</span><span class="token punctuation">:</span> string
    <span class="token key atrule">value</span><span class="token punctuation">:</span> 1.10.3

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx_modules
    <span class="token key atrule">type</span><span class="token punctuation">:</span> array
    <span class="token key atrule">value</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> http_ssl
      <span class="token punctuation">-</span> stream_ssl
      <span class="token punctuation">-</span> mail_ssl
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Your control can be changed to look like this:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
  
  describe nginx <span class="token keyword">do</span>
    input<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'nginx_modules'</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>current_module<span class="token operator">|</span>
      its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'modules'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should <span class="token keyword">include</span> current_module <span class="token punctuation">}</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="_5-2-multiple-inputs-example"><a href="#_5-2-multiple-inputs-example" class="header-anchor">#</a> 5.2. Multiple Inputs Example</h2> <p>To change your inputs for platform specific cases you can setup multiple input files.</p> <p>For example, a inspec.yml:</p> <div class="language-YAML line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> users
    <span class="token key atrule">type</span><span class="token punctuation">:</span> array
    <span class="token key atrule">required</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>A YAML file named windows.yml</p> <div class="language-YAML line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">users</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> Administrator
  <span class="token punctuation">-</span> Guest
  <span class="token punctuation">-</span> Randy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>A YAML file named linux.yml</p> <div class="language-YAML line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">users</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> root
  <span class="token punctuation">-</span> shadow
  <span class="token punctuation">-</span> rmadison
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The control file:</p> <div class="language-Ruby line-numbers-mode"><pre class="language-ruby"><code>control <span class="token string-literal"><span class="token string">'system-users'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">0.8</span>
  desc <span class="token string-literal"><span class="token string">'Confirm the proper users are created on the system'</span></span>

  describe users <span class="token keyword">do</span>
    its<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'usernames'</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> should eq input<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'users'</span></span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>The following command runs the tests and applies the inputs specified:</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>inspec <span class="token builtin class-name">exec</span> examples/profile-input --input-file examples/windows.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>inspec <span class="token builtin class-name">exec</span> examples/profile-input --input-file examples/linux.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_5-3-running-the-baseline-straight-from-github"><a href="#_5-3-running-the-baseline-straight-from-github" class="header-anchor">#</a> 5.3. Running the baseline straight from Github</h2> <p>In this module, we use NGINX for learning purposes. If you're interested in NGINX specifically, you may be interested in the <a href="https://github.com/mitre/nginx-srg-baseline" target="_blank" rel="noopener noreferrer">MITRE nginx-srg-baseline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> profile on GitHub.</p> <p>To execute the GitHub profile on your target system, run this <code>inspec exec</code> command.</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>inspec <span class="token builtin class-name">exec</span> https://github.com/mitre/nginx-baseline -t docker://DOCKER_CONTAINER_ID
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/inspec-developer/course/4.html" class="prev">
        4. Exploring the InSpec Shell
      </a></span> <span class="next"><a href="/inspec-developer/course/6.html">
        6. Generating Results
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/inspec-developer/assets/js/app.7d79d2ea.js" defer></script><script src="/inspec-developer/assets/js/2.fb9f3b04.js" defer></script><script src="/inspec-developer/assets/js/22.0df2a838.js" defer></script>
  </body>
</html>

(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{451:function(s,t,n){"use strict";n.r(t);var a=n(65),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"_5-writting-the-inspec-controls"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-writting-the-inspec-controls"}},[s._v("#")]),s._v(" 5. Writting the InSpec Controls")]),s._v(" "),n("p",[s._v("Now that you understand which methods map to each requirement, you're ready to write InSpec controls.")]),s._v(" "),n("h3",{attrs:{id:"security-configuration-requirements"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#security-configuration-requirements"}},[s._v("#")]),s._v(" Security & Configuration Requirements")]),s._v(" "),n("p",[s._v("Recall from "),n("RouterLink",{attrs:{to:"/course/4.html"}},[s._v("Section 4")]),s._v(" that we want to verify that our NGINX instance had been configured to meet the following requirements:")],1),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(". NGINX version "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.10")]),s._v(".3 or later.\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(". the following NGINX modules should be installed:\n   * "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("http_ssl"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n   * "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("stream_ssl"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n   * "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("mail_ssl"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(". the NGINX configuration "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" - "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/etc/nginx/nginx.conf"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("- should:\n   * be owned by the "),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("root"),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(" user and group.\n   * not be readable, writeable, or executable by others.\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"requirement-1-nginx-version"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#requirement-1-nginx-version"}},[s._v("#")]),s._v(" Requirement (1) - NGINX Version")]),s._v(" "),n("p",[s._v("The first requirement is for the NGINX version to be "),n("code",[s._v("1.10.3 or later")]),s._v(".")]),s._v(" "),n("p",[s._v("We can check this using the InSpec "),n("code",[s._v("cmp")]),s._v(" matcher.")]),s._v(" "),n("p",[s._v("Replace the contents of "),n("code",[s._v("my_nginx/controls/example.rb")]),s._v(" with this:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-version'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX version'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required version of NGINX should be installed.'")])]),s._v("\n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'version'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.10.3'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("The `nginx_conf` resource docs")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/nginx_conf/",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("nginx_conf")]),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("The test has an impact of 1.0, meaning it is most critical. A failure might indicate to the team that this issue should be resolved as soon as possible, likely by upgrading NGINX to a newer version. The test compares "),n("code",[s._v("nginx.version")]),s._v(" against version 1.10.3.")]),s._v(" "),n("p",[n("code",[s._v("cmp")]),s._v(" is one of InSpec's "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/matchers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("built-in matchers"),n("OutboundLink")],1),s._v(". "),n("code",[s._v("cmp")]),s._v(" understands version numbers and can use the operators ==, <, <=, >=, and >. "),n("code",[s._v("cmp")]),s._v(' compares versions by each segment, not as a string. For example, "7.4" is less than than "7.30".')]),s._v(" "),n("p",[s._v("Next, run "),n("code",[s._v("inspec exec")]),s._v(" to execute the profile on the remote target.")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" /root/my_nginx -t docker://DOCKER_CONTAINER_ID\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("This will ouput:")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("  Profile: InSpec Profile "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Version: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(".0\n  Target:  docker://DOCKER_CONTAINER_ID\n\n    ✔  nginx-version: NGINX version\n       ✔  Nginx Environment version should "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.10.3"')]),s._v("\n\n\n  Profile Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" successful control, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" control failures, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" controls skipped\n  Test Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" successful, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" failures, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" skipped\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("You see that the test passes.")]),s._v(" "),n("h3",{attrs:{id:"requirement-2-nginx-modules-are-installed"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#requirement-2-nginx-modules-are-installed"}},[s._v("#")]),s._v(" Requirement (2) - NGINX Modules are Installed")]),s._v(" "),n("p",[s._v("The second requirement verifies that our required modules are installed.")]),s._v(" "),n("ul",[n("li",[s._v("http_ssl")]),s._v(" "),n("li",[s._v("stream_ssl")]),s._v(" "),n("li",[s._v("mail_ssl")])]),s._v(" "),n("p",[s._v("Append your control file to add this describe block:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-modules'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX modules'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required NGINX modules should be installed.'")])]),s._v("\n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stream_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mail_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("The `nginx_conf` resource docs")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/nginx_conf/",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("nginx_conf")]),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("The second control resembles the first; however, this version uses multiple "),n("code",[s._v("its")]),s._v(" statements and the "),n("code",[s._v("nginx.modules")]),s._v(" method. The "),n("code",[s._v("nginx.modules")]),s._v(" method returns a list; the built-in "),n("code",[s._v("include")]),s._v(" matcher verifies whether a value belongs to a given list.")]),s._v(" "),n("p",[s._v("Run "),n("code",[s._v("inspec exec")]),s._v(" on the target.")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("$ inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" /root/my_nginx -t docker://DOCKER_CONTAINER_ID\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Which again, will output:")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("\n  Profile: InSpec Profile "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Version: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(".0\n  Target:  docker://DOCKER_CONTAINER_ID\n\n    ✔  nginx-version: NGINX version\n       ✔  Nginx Environment version should "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cmp")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.10.3"')]),s._v("\n    ✔  nginx-modules: NGINX version\n       ✔  Nginx Environment modules should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http_ssl"')]),s._v("\n       ✔  Nginx Environment modules should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stream_ssl"')]),s._v("\n       ✔  Nginx Environment modules should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mail_ssl"')]),s._v("\n\n\n  Profile Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" successful controls, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" control failures, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" controls skipped\n  Test Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" successful, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" failures, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" skipped\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("This time, both controls pass.")]),s._v(" "),n("h3",{attrs:{id:"requirement-3-permission-on-the-nginx-conf-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#requirement-3-permission-on-the-nginx-conf-file"}},[s._v("#")]),s._v(" Requirement (3) - Permission on the "),n("code",[s._v("nginx_conf")]),s._v(" file")]),s._v(" "),n("p",[s._v("The third requirement verifies that the NGINX configuration file, "),n("code",[s._v("/etc/nginx/nginx.conf")]),s._v(":")]),s._v(" "),n("ul",[n("li",[s._v("is owned by the root user and group.")]),s._v(" "),n("li",[s._v("is not be readable, writeable, or executable by others.")])]),s._v(" "),n("p",[s._v("Append your control file to add this describe block:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-conf'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX configuration'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'")])]),s._v("\n  describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/nginx/nginx.conf'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_owned_by "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_grouped_into "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_readable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_writable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_executable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("The `file` resource docs")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/file/",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("file")]),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("The third control uses the "),n("code",[s._v("file")]),s._v(" resource. The first 2 tests use "),n("code",[s._v("should")]),s._v(" to verify the "),n("code",[s._v("root")]),s._v(" owner and group. The last 3 tests use "),n("code",[s._v("should_not")]),s._v(" to verify that the file is not readable, writable, or executable by others.")]),s._v(" "),n("p",[s._v("Run "),n("code",[s._v("inspec exec")]),s._v(" on the target.")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("$ inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" /root/my_nginx -t docker://DOCKER_CONTAINER_ID\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Again, outputting:")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("  Profile: InSpec Profile "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  Version: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.1")]),s._v(".0\n  Target:  docker://DOCKER_CONTAINER_ID\n\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n    ×  nginx-conf: NGINX configuration "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" failed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n       ✔  File /etc/nginx/nginx.conf should be owned by "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n       ✔  File /etc/nginx/nginx.conf should be grouped into "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root"')]),s._v("\n       ×  File /etc/nginx/nginx.conf should not be readable by others\n       expected File /etc/nginx/nginx.conf not to be readable by others\n       ✔  File /etc/nginx/nginx.conf should not be writable by others\n       ✔  File /etc/nginx/nginx.conf should not be executable by others\n\n\n  Profile Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" successful controls, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" control failure, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" controls skipped\n  Test Summary: "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" successful, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" failure, "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" skipped\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("This time you see a failure. You discover that "),n("code",[s._v("/etc/nginx/nginx.conf")]),s._v(" is potentially readable by others. Because this control also has an impact of 1.0, your team may need to investigate further.")]),s._v(" "),n("p",[s._v("Remember, the first step, detect, is where you identify where the problems are so that you can accurately assess risk and prioritize remediation actions.")]),s._v(" "),n("p",[s._v("For the second step, correct, you can use a configuration management tool or some other automation framework to correct compliance failures for you.")]),s._v(" "),n("p",[s._v("You won't correct this issue in this module, but later you can check out the "),n("a",{attrs:{href:"https://learn.chef.io/tracks/integrated-compliance#/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Integrated Compliance with Chef"),n("OutboundLink")],1),s._v(" track to learn more about how to correct compliance issues using Chef.")]),s._v(" "),n("h2",{attrs:{id:"_5-1-refactoring-the-code-to-use-inputs"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-refactoring-the-code-to-use-inputs"}},[s._v("#")]),s._v(" 5.1. Refactoring the code to use Inputs")]),s._v(" "),n("p",[s._v("Your "),n("code",[s._v("my_nginx")]),s._v(" profile is off to a great start. As your requirements evolve, you can add additional controls. You can also run this profile as often as you need to verify whether your systems remain in compliance.")]),s._v(" "),n("p",[s._v("Let's review the control file, "),n("code",[s._v("example.rb")]),s._v(".")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-version'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX version'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required version of NGINX should be installed.'")])]),s._v("\n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'version'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.10.3'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\ncontrol "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-modules'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX modules'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required NGINX modules should be installed.'")])]),s._v("\n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stream_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mail_ssl'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\ncontrol "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-conf'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX configuration'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'")])]),s._v("\n  describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/nginx/nginx.conf'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_owned_by "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_grouped_into "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_readable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_writable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_executable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'others'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[s._v("The `nginx_conf` resource docs")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/nginx_conf/",target:"_blank",rel:"noopener noreferrer"}},[n("code",[s._v("nginx_conf")]),n("OutboundLink")],1)])]),s._v(" "),n("p",[s._v("Although these rules do what you expect, imagine your control file contains dozens or hundreds of tests. As the data you check for, such as the version or which modules are installed, evolve, it can become tedious to locate and update your tests. You may also find that you repeat the same data in across multiple control files.")]),s._v(" "),n("p",[s._v("One way to improve these tests is to use "),n("code",[s._v("inputs")]),s._v(". "),n("code",[s._v("Inputs")]),s._v(" enable you to separate the "),n("code",[s._v("logic of your tests")]),s._v(" from "),n("code",[s._v("the data your tests")]),s._v(". "),n("code",[s._v("Input files")]),s._v(" are typically expressed as a "),n("code",[s._v("YAML")]),s._v(" file.")]),s._v(" "),n("p",[n("code",[s._v("Profile Inputs")]),s._v(" exist in your profile's main directory within the "),n("code",[s._v("inspec.yml")]),s._v(" for global "),n("code",[s._v("inputs")]),s._v(" to be used across all the controls in your profile.")]),s._v(" "),n("p",[s._v("Let's create the "),n("code",[s._v("inspec.yml")]),s._v(" file for our profile:")]),s._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my_nginx\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" InSpec Profile\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maintainer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" The Authors\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copyright")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" The Authors\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copyright_email")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" you@example.com\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("license")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("summary")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" An InSpec Compliance Profile\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.1.0\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("supports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("platform")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" os\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("inputs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx_version\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" string\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1.10.3\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("To access an input you will use the input keyword. You can use this anywhere in your control code.")]),s._v(" "),n("p",[s._v("For example:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-version'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX version'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required version of NGINX should be installed.'")])]),s._v("\n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'version'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx_version'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("For our next control we require specific modules")]),s._v(" "),n("p",[s._v("Example of adding an array object of servers:")]),s._v(" "),n("div",{staticClass:"language-YAML line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("inputs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" servers\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" array\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" server1\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" server2\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" server3\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("Similarly as the above example we can edit our "),n("code",[s._v("inspec.yml")]),s._v(" file like this:")]),s._v(" "),n("div",{staticClass:"language-YAML line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my_nginx\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("title")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" InSpec Profile\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("maintainer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" The Authors\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copyright")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" The Authors\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("copyright_email")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" you@example.com\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("license")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Apache"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("summary")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" An InSpec Compliance Profile\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 0.1.0\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("supports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("platform")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" os\n\n"),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("inputs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx_version\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" string\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 1.10.3\n\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx_modules\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" array\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("value")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" http_ssl\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" stream_ssl\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" mail_ssl\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("Your control can be changed to look like this:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx-modules'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NGINX modules'")])]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'The required NGINX modules should be installed.'")])]),s._v("\n  \n  describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'nginx_modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("current_module"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n      its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" current_module "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"_5-2-multiple-inputs-example"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-multiple-inputs-example"}},[s._v("#")]),s._v(" 5.2. Multiple Inputs Example")]),s._v(" "),n("p",[s._v("To change your inputs for platform specific cases you can setup multiple input files.")]),s._v(" "),n("p",[s._v("For example, a inspec.yml:")]),s._v(" "),n("div",{staticClass:"language-YAML line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("inputs")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" users\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" array\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("required")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("A YAML file named windows.yml")]),s._v(" "),n("div",{staticClass:"language-YAML line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("users")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Administrator\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Guest\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" Randy\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("A YAML file named linux.yml")]),s._v(" "),n("div",{staticClass:"language-YAML line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("users")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" root\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" shadow\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" rmadison\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("The control file:")]),s._v(" "),n("div",{staticClass:"language-Ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'system-users'")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Confirm the proper users are created on the system'")])]),s._v("\n\n  describe users "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'usernames'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should eq input"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string-literal"}},[n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'users'")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("The following command runs the tests and applies the inputs specified:")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" examples/profile-input --input-file examples/windows.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" examples/profile-input --input-file examples/linux.yml\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_5-3-running-the-baseline-straight-from-github"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-3-running-the-baseline-straight-from-github"}},[s._v("#")]),s._v(" 5.3. Running the baseline straight from Github")]),s._v(" "),n("p",[s._v("In this module, we use NGINX for learning purposes. If you're interested in NGINX specifically, you may be interested in the "),n("a",{attrs:{href:"https://github.com/mitre/nginx-srg-baseline",target:"_blank",rel:"noopener noreferrer"}},[s._v("MITRE nginx-srg-baseline"),n("OutboundLink")],1),s._v(" profile on GitHub.")]),s._v(" "),n("p",[s._v("To execute the GitHub profile on your target system, run this "),n("code",[s._v("inspec exec")]),s._v(" command.")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" https://github.com/mitre/nginx-baseline -t docker://DOCKER_CONTAINER_ID\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);